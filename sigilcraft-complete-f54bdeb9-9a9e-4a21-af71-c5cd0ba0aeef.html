<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SigilCraft Elite</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body{background-color:#050505;color:#e5e5e5;margin:0;overflow:hidden}
        ::-webkit-scrollbar{width:4px}
        ::-webkit-scrollbar-track{background:transparent}
        ::-webkit-scrollbar-thumb{background:#333;border-radius:10px}
        .modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);display:flex;align-items:center;justify-content:center;z-index:9999}
        .modal-content{background:#1a1a1a;padding:32px;border-radius:24px;max-width:500px;width:90%;border:1px solid rgba(102,126,234,0.3)}
        .modal input{width:100%;padding:16px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:12px;color:white;font-size:14px;margin-top:16px}
        .modal button{width:100%;padding:16px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;border-radius:12px;font-weight:600;margin-top:16px;cursor:pointer}
        input[type="color"]{width:100%;height:50px;border:none;border-radius:8px;cursor:pointer}
    </style>
    <script type="importmap">{"imports":{"react":"https://esm.sh/react@19.0.0","react-dom/client":"https://esm.sh/react-dom@19.0.0/client"}}</script>
</head>
<body>
    <div id="root"></div>
    <script>
        const tg=window.Telegram?.WebApp;
        if(tg){tg.ready();tg.expand();if(tg.themeParams?.bg_color)document.body.style.backgroundColor=tg.themeParams.bg_color;console.log('‚úÖ Telegram WebApp')}
        window.AppMode={SIGIL:'–°–∏–≥–∏–ª—ã',ASSOCIATION:'–ê—Å—Å–æ—Ü–∏–∞—Ü–∏–∏'};
        window.RenderingStyle={CARTOON:'–ö–∞—Ä–∏–∫–∞—Ç—É—Ä–Ω—ã–π/–ú—É–ª—å—Ç—è—à–Ω—ã–π',COMIC:'–ö–æ–º–∏–∫—Å (Retro/Marvel)',PENCIL:'–ö–∞—Ä–∞–Ω–¥–∞—à–Ω—ã–π —Ä–∏—Å—É–Ω–æ–∫',INK:'–ß–µ—Ä–Ω–æ-–±–µ–ª–∞—è —Ç—É—à—å',SKETCH:'–ñ–∏–≤–æ–π —ç—Å–∫–∏–∑',KAWAII:'–ú–∏–ª—ã–π (Kawaii)',HYPERREALISM:'–ì–∏–ø–µ—Ä—Ä–µ–∞–ª–∏–∑–º',SCHEMATIC:'–°—Ö–µ–º–∞—Ç–∏—á–Ω—ã–π/–ß–µ—Ä—Ç–µ–∂',CONVEX_3D:'–í—ã–ø—É–∫–ª—ã–π 3D —Ä–µ–ª—å–µ—Ñ',REALISM:'–§–æ—Ç–æ—Ä–µ–∞–ª–∏–∑–º'};
        window.MagicVibe={GLOWING:'–ú–∞–≥–∏—á–µ—Å–∫–æ–µ —Å–∏—è–Ω–∏–µ',MYSTERIOUS:'–ó–∞–≥–∞–¥–æ—á–Ω—ã–π —à–µ–ø–æ—Ç',ETHEREAL:'–≠—Ñ–∏—Ä–Ω–∞—è –ø—ã–ª—å'};
        window.BackgroundPreset={DARK_MINIMAL:'–¢–µ–º–Ω—ã–π –º–∏–Ω–∏–º–∞–ª–∏–∑–º',LIGHT_MINIMAL:'–°–≤–µ—Ç–ª—ã–π –º–∏–Ω–∏–º–∞–ª–∏–∑–º',COSMIC_NEBULA:'–ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Ç—É–º–∞–Ω–Ω–æ—Å—Ç—å',HOLOGRAPHIC_GRADIENT:'–ì–æ–ª–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç',ETHEREAL_MIST:'–≠—Ñ–∏—Ä–Ω—ã–π —Ç—É–º–∞–Ω',OBSIDIAN_CHAMBER:'–û–±—Å–∏–¥–∏–∞–Ω–æ–≤–∞—è –∫–∞–º–µ—Ä–∞'};
        window.SymbolPosition={CENTER:'–¶–µ–Ω—Ç—Ä',TOP:'–í–µ—Ä—Ö',BOTTOM:'–ù–∏–∑'};
        window.SIGIL_DATABASE=[
            {id:1,name:"The Whisper",nameRu:"–®—ë–ø–æ—Ç",element:'–í–æ–∑–¥—É—Ö',visualTz:"Thin curved line, gently splitting into two branches",baseColor:"#87CEEB"},
            {id:2,name:"Gate of Winds",nameRu:"–í—Ä–∞—Ç–∞ –í–µ—Ç—Ä–æ–≤",element:'–í–æ–∑–¥—É—Ö',visualTz:"Two parallel vertical lines, between them a vortex shift",baseColor:"#87CEEB"},
            {id:12,name:"The Ripple",nameRu:"–†—è–±—å",element:'–í–æ–¥–∞',visualTz:"Concentric circles, radiating from a point",baseColor:"#00CED1"},
            {id:23,name:"The Spark",nameRu:"–ò—Å–∫—Ä–∞",element:'–û–≥–æ–Ω—å',visualTz:"Small flash: short line + splitting",baseColor:"#FF8C00"},
            {id:34,name:"Rootmark",nameRu:"–ö–æ—Ä–µ–Ω—å",element:'–ó–µ–º–ª—è',visualTz:"Y-shaped or root-like line",baseColor:"#808000"},
            {id:45,name:"Thread of Fate",nameRu:"–ù–∏—Ç—å –°—É–¥—å–±—ã",element:'–≠—Ñ–∏—Ä',visualTz:"One vertical line - straight, inevitable",baseColor:"#FFD700"},
            {id:66,name:"Catalyst",nameRu:"–ö–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä",element:'–ü–ª–µ—Ç–µ–Ω–∏–µ',visualTz:"Central point + diverging short rays",baseColor:"#FFD700"}
        ];
        window.getApiKey=()=>localStorage.getItem('gemini_api_key');
        window.setApiKey=(key)=>localStorage.setItem('gemini_api_key',key);
        console.log('‚úÖ –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
    </script>
    <script type="module">
        import React,{useState} from 'react';
        import ReactDOM from 'react-dom/client';
        const {AppMode,RenderingStyle,MagicVibe,BackgroundPreset,SymbolPosition,SIGIL_DATABASE}=window;

        const generateCardImage=async(config,apiKey)=>{
            const getStyleDescription=(style)=>{
                const styles={
                    [RenderingStyle.CARTOON]:"Bold, stylized illustration with expressive shapes and dynamic line work.",
                    [RenderingStyle.COMIC]:"Classic American comic book style, vibrant halftones (Ben-Day dots), thick ink outlines, and dynamic action-oriented shading.",
                    [RenderingStyle.PENCIL]:"Detailed graphite pencil drawing with realistic cross-hatching and paper grain.",
                    [RenderingStyle.INK]:"Sharp black ink wash, calligraphic precision, heavy contrast, master pen work.",
                    [RenderingStyle.SKETCH]:"Loose charcoal or lead sketch with artistic construction lines and raw texture.",
                    [RenderingStyle.KAWAII]:"Cute, simplified aesthetic with rounded proportions and clean outlines.",
                    [RenderingStyle.HYPERREALISM]:"Extreme micro-detail, professional studio depth, cinematic lighting textures.",
                    [RenderingStyle.SCHEMATIC]:"Technical drafting style, precise mathematical lines, architectural blueprint aesthetic.",
                    [RenderingStyle.CONVEX_3D]:"3D embossed material relief with physical shadows and tactile volume.",
                    [RenderingStyle.REALISM]:"Professional photographic aesthetic with accurate surface materials."
                };
                return styles[style]||"";
            };

            const colorInstruction=config.isMonochrome?"STRICT MONOCHROME: High-contrast black and white. Newspaper ink aesthetic.":"VIBRANT COLOR: Rich, saturated hues and professional color grading.";
            const styleBase=getStyleDescription(config.renderingStyle);
            const textDrawingInstruction=config.allowAiText?"AI TEXT ALLOWED: Include artistic text elements naturally.":"STRICTLY NO TEXT: Pure graphics only.";

            let prompt="";

            if(config.mode===AppMode.SIGIL){
                const thicknessDesc=config.lineThickness<1.5?"ultra-fine needle-thin strokes":config.lineThickness<3.0?"refined lines with elegant weight":"heavy, powerful and bold lines";
                const glowDescription=config.glowIntensity<15?"a ghostly subtle whisper of energy":config.glowIntensity<50?"a radiant magical atmosphere":"an intense pulsating energy aura";
                const vibeDetails={
                    [MagicVibe.GLOWING]:"Surrounded by crystalline light shards.",
                    [MagicVibe.MYSTERIOUS]:"Wrapped in swirling dark smoke and enigmatic shadows.",
                    [MagicVibe.ETHEREAL]:"Dusted with shimmering cosmic particles."
                };
                const vibeDetail=vibeDetails[config.magicVibe]||"";
                const frameStyle=config.showBorder?"A high-quality physical collector's card frame with intricate borders.":"No frame, cinematic edge-to-edge composition.";
                const inscriptionInstruction=config.showInscription?`At the bottom of the card, the word "${config.symbolName.toUpperCase()}" is cleanly engraved into the frame.`:"Do not add any specific label text for the symbol name.";
                const auraColorStr=config.isMonochrome?"grayscale contrast levels":config.auraColor;
                const positionDesc=`The symbol is at the ${config.position.toLowerCase()} with scale ${config.symbolSize}%.`;

                prompt=`COLLECTIBLE ART SYNTHESIS.
OBJECT: Mystical artifact card.
CENTRAL SYMBOL: "${config.visualTz}".
COMPOSITION: ${positionDesc}.
COLOR MODE: ${colorInstruction}.
STYLE: ${styleBase}.
TEXT RULES: ${textDrawingInstruction}
LINE TREATMENT: ${thicknessDesc}.
ENERGY: ${config.magicVibe}. ${vibeDetail}
LIGHTING: ${glowDescription} (Aura expressed as ${auraColorStr}).
BACKGROUND: ${config.backgroundPreset}.
FRAME: ${frameStyle}
UI INSCRIPTION: ${inscriptionInstruction}
TECHNICAL: 8k resolution, crisp textures, dramatic lighting.`;
            }else{
                prompt=`CONCEPTUAL PHILOSOPHICAL ART.
SUBJECT: "${config.conceptWord}".
COLOR MODE: ${colorInstruction}.
STYLE: ${styleBase}. 
TEXT RULES: ${textDrawingInstruction}
ATMOSPHERE: Poetic, evocative, masterfully minimalist.
COMPOSITION: Powerful use of negative space and stark visual metaphor.
VISUAL METAPHOR: If the subject involves people or crowds, use silhouettes or detailed pen-and-ink figures consistent with the chosen style.`;
            }

            console.log('üîß –ü—Ä–æ–º–ø—Ç:',prompt);

            const contents={parts:[{text:prompt}]};
            if(config.mode===AppMode.SIGIL&&config.referenceImage){
                const base64Data=config.referenceImage.split(',')[1]||config.referenceImage;
                contents.parts.unshift({inlineData:{mimeType:'image/png',data:base64Data}});
            }

            const response=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image:generateContent?key=${apiKey}`,{
                method:'POST',
                headers:{'Content-Type':'application/json'},
                body:JSON.stringify({contents:[contents],generationConfig:{temperature:0.9,topK:40,topP:0.95}})
            });

            if(!response.ok){
                const error=await response.json();
                console.error('‚ùå –û—à–∏–±–∫–∞:',error);
                throw new Error(error.error?.message||'–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏');
            }

            const data=await response.json();
            console.log('‚úÖ –û—Ç–≤–µ—Ç:',data);

            const imagePart=data.candidates?.[0]?.content?.parts?.find(p=>p.inlineData);
            if(imagePart?.inlineData){
                return {imageUrl:`data:image/png;base64,${imagePart.inlineData.data}`};
            }

            throw new Error("–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ");
        };

        const ApiKeyModal=({onSubmit})=>{
            const [key,setKey]=useState('');
            return React.createElement('div',{className:"modal"},
                React.createElement('div',{className:"modal-content"},
                    React.createElement('h2',{style:{fontSize:'24px',fontWeight:'bold',marginBottom:'16px'}},'üîë Gemini API Key'),
                    React.createElement('p',{style:{fontSize:'14px',color:'#888',marginBottom:'8px'}},'–ü–æ–ª—É—á–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–ª—é—á:'),
                    React.createElement('a',{href:'https://aistudio.google.com/apikey',target:'_blank',style:{color:'#667eea',fontSize:'14px',textDecoration:'underline'}},'aistudio.google.com/apikey'),
                    React.createElement('input',{type:'text',placeholder:'–í—Å—Ç–∞–≤—å API –∫–ª—é—á...',value:key,onChange:(e)=>setKey(e.target.value)}),
                    React.createElement('button',{onClick:()=>{if(key.trim()){window.setApiKey(key.trim());onSubmit()}}},'–°–æ—Ö—Ä–∞–Ω–∏—Ç—å')
                )
            );
        };

        const ControlPanel=({config,onChange,onGenerate,isGenerating})=>{
            const handleChange=(key,value)=>onChange({...config,[key]:value});
            const onSymbolSelect=(e)=>{
                const id=parseInt(e.target.value);
                const template=SIGIL_DATABASE.find(s=>s.id===id);
                if(template)onChange({...config,selectedSymbolId:id,symbolNumber:`#${id.toString().padStart(3,'0')}`,symbolName:template.nameRu,element:template.element,visualTz:template.visualTz,auraColor:template.baseColor});
            };
            const handleFileUpload=(e)=>{
                const file=e.target.files[0];
                if(!file)return;
                const reader=new FileReader();
                reader.onload=(ev)=>handleChange('referenceImage',ev.target.result);
                reader.readAsDataURL(file);
            };

            const labelClass="text-[9px] font-black text-gray-500 uppercase tracking-widest mb-3";
            const inputBg="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-[12px] text-white focus:outline-none focus:border-indigo-500/50 transition-all";

            return React.createElement('div',{className:"h-full flex flex-col bg-[#0a0a0a]"},
                React.createElement('div',{className:"flex items-center gap-4 p-8 border-b border-white/5"},
                    React.createElement('div',{className:"w-12 h-12 bg-indigo-600 rounded-2xl flex items-center justify-center shadow-lg shadow-indigo-500/20"},
                        React.createElement('i',{className:"fa-solid fa-wand-magic-sparkles text-white text-xl"})
                    ),
                    React.createElement('div',null,
                        React.createElement('h1',{className:"text-xl font-black text-white uppercase italic leading-none mb-1"},"Sigil Craft"),
                        React.createElement('p',{className:"text-[9px] text-gray-600 font-bold uppercase tracking-widest"},"Collector Studio PRO")
                    )
                ),

                React.createElement('div',{className:"flex-1 overflow-y-auto p-8 space-y-8"},
                    React.createElement('div',{className:"flex gap-2 p-1.5 bg-white/5 rounded-2xl border border-white/5"},
                        React.createElement('button',{onClick:()=>handleChange('mode',AppMode.SIGIL),className:`flex-1 py-2.5 text-[10px] font-black uppercase rounded-xl transition-all ${config.mode===AppMode.SIGIL?'bg-indigo-600 text-white shadow-lg':'text-gray-500 hover:text-gray-300'}`},"–°–∏–≥–∏–ª—ã"),
                        React.createElement('button',{onClick:()=>handleChange('mode',AppMode.ASSOCIATION),className:`flex-1 py-2.5 text-[10px] font-black uppercase rounded-xl transition-all ${config.mode===AppMode.ASSOCIATION?'bg-indigo-600 text-white shadow-lg':'text-gray-500 hover:text-gray-300'}`},"–ê—Å—Å–æ—Ü–∏–∞—Ü–∏–∏")
                    ),

                    config.mode===AppMode.SIGIL?React.createElement('section',{className:"space-y-6"},
                        React.createElement('div',null,
                            React.createElement('div',{className:labelClass},"–í—ã–±–æ—Ä –±–∞–∑–æ–≤–æ–≥–æ –∑–Ω–∞–∫–∞"),
                            React.createElement('select',{value:config.selectedSymbolId,onChange:onSymbolSelect,className:inputBg},
                                SIGIL_DATABASE.map(s=>React.createElement('option',{key:s.id,value:s.id},`#${s.id.toString().padStart(3,'0')} ‚Äî ${s.nameRu}`))
                            )
                        ),

                        React.createElement('div',null,
                            React.createElement('div',{className:labelClass},
                                React.createElement('span',null,"–¢–æ–ª—â–∏–Ω–∞ –ª–∏–Ω–∏–π"),
                                React.createElement('span',{className:"text-indigo-400 font-mono text-[8px]"},config.lineThickness.toFixed(1)+"px")
                            ),
                            React.createElement('input',{type:"range",min:"1.0",max:"5.0",step:"0.1",value:config.lineThickness,onChange:(e)=>handleChange('lineThickness',parseFloat(e.target.value)),className:"w-full accent-indigo-500 h-1 bg-white/10 rounded-full"})
                        ),

                        React.createElement('div',null,
                            React.createElement('div',{className:labelClass},
                                React.createElement('span',null,"–≠–Ω–µ—Ä–≥–∏—è (Glow)"),
                                React.createElement('span',{className:"text-indigo-400 font-mono text-[8px]"},config.glowIntensity+"%")
                            ),
                            React.createElement('input',{type:"range",min:"0",max:"100",value:config.glowIntensity,onChange:(e)=>handleChange('glowIntensity',parseInt(e.target.value)),className:"w-full accent-indigo-500 h-1 bg-white/10 rounded-full"})
                        ),

                        React.createElement('div',null,
                            React.createElement('div',{className:labelClass},
                                React.createElement('span',null,"–ú–∞—Å—à—Ç–∞–± –æ–±—ä–µ–∫—Ç–∞"),
                                React.createElement('span',{className:"text-indigo-400 font-mono text-[8px]"},config.symbolSize+"%")
                            ),
                            React.createElement('input',{type:"range",min:"20",max:"90",value:config.symbolSize,onChange:(e)=>handleChange('symbolSize',parseInt(e.target.value)),className:"w-full accent-indigo-500 h-1 bg-white/10 rounded-full"})
                        )
                    ):React.createElement('section',{className:"space-y-6"},
                        React.createElement('div',null,
                            React.createElement('div',{className:labelClass},"–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å"),
                            React.createElement('textarea',{value:config.conceptWord,onChange:(e)=>handleChange('conceptWord',e.target.value),placeholder:"–û–ø–∏—à–∏—Ç–µ –∏–¥–µ—é –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏...",className:`${inputBg} min-h-[100px] resize-none`})
                        )
                    ),

                    React.createElement('section',{className:"space-y-6 border-t border-white/5 pt-8"},
                        React.createElement('div',null,
                            React.createElement('div',{className:labelClass},"–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å—Ç–∏–ª—å"),
                            React.createElement('select',{value:config.renderingStyle,onChange:(e)=>handleChange('renderingStyle',e.target.value),className:inputBg},
                                Object.values(RenderingStyle).map(v=>React.createElement('option',{key:v,value:v},v))
                            )
                        ),

                        React.createElement('div',null,
                            React.createElement('div',{className:labelClass},"–ú–∞–≥–∏—á–µ—Å–∫–∞—è –≤–∏–±—Ä–∞—Ü–∏—è"),
                            React.createElement('select',{value:config.magicVibe,onChange:(e)=>handleChange('magicVibe',e.target.value),className:inputBg},
                                Object.values(MagicVibe).map(v=>React.createElement('option',{key:v,value:v},v))
                            )
                        ),

                        React.createElement('div',null,
                            React.createElement('div',{className:labelClass},"–§–æ–Ω"),
                            React.createElement('select',{value:config.backgroundPreset,onChange:(e)=>handleChange('backgroundPreset',e.target.value),className:inputBg},
                                Object.values(BackgroundPreset).map(v=>React.createElement('option',{key:v,value:v},v))
                            )
                        ),

                        React.createElement('div',null,
                            React.createElement('div',{className:labelClass},"–¶–≤–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –∞—É—Ä—ã"),
                            React.createElement('input',{type:"color",value:config.auraColor,onChange:(e)=>handleChange('auraColor',e.target.value),className:"w-full h-12 rounded-xl cursor-pointer"})
                        ),

                        React.createElement('div',null,
                            React.createElement('div',{className:labelClass},"–†–µ—Ñ–µ—Ä–µ–Ω—Å –∏–ª–∏ –Ω–∞–±—Ä–æ—Å–æ–∫"),
                            React.createElement('input',{type:"file",accept:"image/*",onChange:handleFileUpload,className:"w-full text-[12px] text-gray-400"})
                        ),

                        React.createElement('div',{className:"flex items-center gap-3"},
                            React.createElement('input',{type:"checkbox",id:"monochromeCheck",checked:config.isMonochrome,onChange:(e)=>handleChange('isMonochrome',e.target.checked),className:"w-5 h-5 accent-indigo-500 cursor-pointer"}),
                            React.createElement('label',{htmlFor:"monochromeCheck",className:"text-[12px] text-gray-300 cursor-pointer"},"–ú–æ–Ω–æ—Ö—Ä–æ–º (B&W)")
                        ),

                        React.createElement('div',{className:"flex items-center gap-3"},
                            React.createElement('input',{type:"checkbox",id:"borderCheck",checked:config.showBorder,onChange:(e)=>handleChange('showBorder',e.target.checked),className:"w-5 h-5 accent-indigo-500 cursor-pointer"}),
                            React.createElement('label',{htmlFor:"borderCheck",className:"text-[12px] text-gray-300 cursor-pointer"},"–†–∞–º–∫–∞")
                        ),

                        React.createElement('div',{className:"flex items-center gap-3"},
                            React.createElement('input',{type:"checkbox",id:"inscriptionCheck",checked:config.showInscription,onChange:(e)=>handleChange('showInscription',e.target.checked),className:"w-5 h-5 accent-indigo-500 cursor-pointer"}),
                            React.createElement('label',{htmlFor:"inscriptionCheck",className:"text-[12px] text-gray-300 cursor-pointer"},"–ì—Ä–∞–≤–∏—Ä–æ–≤–∫–∞ –Ω–∞–∑–≤–∞–Ω–∏—è")
                        ),

                        React.createElement('div',{className:"flex items-center gap-3"},
                            React.createElement('input',{type:"checkbox",id:"aiTextCheck",checked:config.allowAiText,onChange:(e)=>handleChange('allowAiText',e.target.checked),className:"w-5 h-5 accent-indigo-500 cursor-pointer"}),
                            React.createElement('label',{htmlFor:"aiTextCheck",className:"text-[12px] text-gray-300 cursor-pointer"},"AI Text Drawing")
                        )
                    )
                ),

                React.createElement('div',{className:"p-8 bg-[#0a0a0a] border-t border-white/5"},
                    React.createElement('button',{onClick:onGenerate,disabled:isGenerating||(config.mode===AppMode.ASSOCIATION&&!config.conceptWord.trim()),className:`w-full py-5 rounded-2xl font-black text-[12px] tracking-[0.3em] flex items-center justify-center gap-4 transition-all uppercase shadow-2xl ${isGenerating?'bg-neutral-800 text-gray-600':'bg-white text-black hover:scale-[1.02]'}`},
                        isGenerating?React.createElement('i',{className:"fa-solid fa-atom fa-spin text-indigo-500"}):React.createElement('i',{className:"fa-solid fa-bolt"}),
                        React.createElement('span',null,isGenerating?'–°–∏–Ω—Ç–µ–∑–∏—Ä—É—é...':'–°–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞—Ç—å')
                    )
                )
            );
        };

        const FIRST_SYMBOL=SIGIL_DATABASE[0];
        const INITIAL_CONFIG={
            mode:AppMode.SIGIL,
            collectionName:'–•—Ä–æ–Ω–∏–∫–∏ –≠—Ç–µ—Ä–∏—Å–∞',
            isMonochrome:false,
            renderingStyle:RenderingStyle.CONVEX_3D,
            magicVibe:MagicVibe.GLOWING,
            backgroundPreset:BackgroundPreset.DARK_MINIMAL,
            showBorder:true,
            showInscription:false,
            allowAiText:false,
            selectedSymbolId:FIRST_SYMBOL.id,
            symbolNumber:'#001',
            symbolName:FIRST_SYMBOL.nameRu,
            element:FIRST_SYMBOL.element,
            visualTz:FIRST_SYMBOL.visualTz,
            auraColor:FIRST_SYMBOL.baseColor,
            lineThickness:2.0,
            glowIntensity:20,
            symbolSize:55,
            position:SymbolPosition.CENTER,
            conceptWord:'',
            referenceImage:null
        };

        const App=()=>{
            const [config,setConfig]=useState(INITIAL_CONFIG);
            const [result,setResult]=useState(null);
            const [isGenerating,setIsGenerating]=useState(false);
            const [error,setError]=useState(null);
            const [showApiKeyModal,setShowApiKeyModal]=useState(!window.getApiKey());

            const handleGenerate=async()=>{
                const apiKey=window.getApiKey();
                if(!apiKey){setShowApiKeyModal(true);return}
                setIsGenerating(true);setError(null);
                try{
                    const res=await generateCardImage(config,apiKey);
                    setResult(res);
                    if(tg?.HapticFeedback)tg.HapticFeedback.notificationOccurred('success');
                }catch(err){
                    setError(err.message||"–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏");
                    if(tg?.HapticFeedback)tg.HapticFeedback.notificationOccurred('error');
                }finally{
                    setIsGenerating(false);
                }
            };

            return React.createElement('div',null,
                showApiKeyModal&&React.createElement(ApiKeyModal,{onSubmit:()=>setShowApiKeyModal(false)}),
                React.createElement('div',{className:"flex flex-col md:flex-row h-screen w-full bg-[#050505] overflow-hidden font-sans text-white"},
                    React.createElement('aside',{className:"w-full md:w-[400px] h-[50vh] md:h-full flex-shrink-0 z-20 shadow-2xl relative border-b md:border-b-0 md:border-r border-white/5 bg-[#0a0a0a] overflow-hidden"},
                        React.createElement(ControlPanel,{config:config,onChange:setConfig,onGenerate:handleGenerate,isGenerating:isGenerating})
                    ),
                    React.createElement('main',{className:"flex-1 relative flex flex-col items-center justify-center p-6 md:p-12 overflow-hidden"},
                        React.createElement('div',{className:"relative z-10 w-full max-w-[320px] sm:max-w-[500px] md:max-w-[700px] aspect-square rounded-[2rem] md:rounded-[3.5rem] overflow-hidden bg-black shadow-[0_0_80px_rgba(0,0,0,1)] border border-white/[0.08]"},
                            isGenerating?React.createElement('div',{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/95 z-30"},
                                React.createElement('div',{className:"relative w-24 h-24 md:w-40 md:h-40 mb-4 md:mb-8"},
                                    React.createElement('svg',{className:"w-full h-full animate-spin",viewBox:"0 0 100 100"},
                                        React.createElement('circle',{cx:"50",cy:"50",r:"45",fill:"none",stroke:"currentColor",strokeWidth:"3",className:"text-indigo-500",strokeDasharray:"60 180",strokeLinecap:"round"})
                                    )
                                ),
                                React.createElement('div',{className:"text-[10px] md:text-[14px] text-indigo-400 font-black tracking-[0.4em] uppercase animate-pulse"},"–°–∏–Ω—Ç–µ–∑...")
                            ):result?React.createElement('img',{src:result.imageUrl,alt:"Artifact",className:"w-full h-full object-cover p-0.5"}):React.createElement('div',{className:"absolute inset-0 flex flex-col items-center justify-center text-center p-6 md:p-12 opacity-20"},
                                React.createElement('i',{className:"fa-solid fa-fingerprint text-gray-700 text-5xl md:text-7xl mb-4 md:mb-8"}),
                                React.createElement('h3',{className:"text-lg md:text-2xl font-black text-white/50 mb-2 uppercase italic tracking-widest"},"–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ")
                            ),
                            error&&React.createElement('div',{className:"absolute inset-0 bg-red-950/20 backdrop-blur-xl flex items-center justify-center z-50 p-6 md:p-12"},
                                React.createElement('div',{className:"bg-black/90 border border-red-500/30 p-6 md:p-10 rounded-[2rem] md:rounded-[3rem] text-center max-w-sm shadow-2xl"},
                                    React.createElement('i',{className:"fa-solid fa-triangle-exclamation text-red-500 text-2xl md:text-3xl mb-4"}),
                                    React.createElement('p',{className:"text-white text-xs md:text-sm font-medium mb-6"},error),
                                    React.createElement('button',{onClick:()=>setError(null),className:"px-6 md:px-8 py-2 md:py-3 bg-white text-black text-[8px] md:text-[10px] font-black uppercase rounded-full tracking-widest"},"–°–±—Ä–æ—Å")
                                )
                            )
                        )
                    )
                )
            );
        };

        const root=ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
        console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ —Å–æ –í–°–ï–ú–ò –æ–ø—Ü–∏—è–º–∏!');
    </script>
</body>
</html>